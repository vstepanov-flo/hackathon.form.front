import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable, of } from 'rxjs';
import { environment } from '../../../environments/environment';
import { ApplicationForm } from './behavior-subject.service';
import { CityInfo } from './organization-cache.service';

export interface ObjectType {
  [k:string]: string;
}

@Injectable({
  providedIn: 'root'
})
export class ApiService {

  constructor(private httpClient: HttpClient) { }

  public getClientIpInfo(): Observable<any> {
    return this.#get('https://api.ipgeolocation.io/ipgeo', { apiKey: environment.ipgeolocationApiKey });
  }

  public getCitiesInfo(): Observable<CityInfo[]> {
    // return this.#get(`${environment.apiUrl}`)
    return of([{"city":"Краснодар","organizations":[{"address":"350038, Краснодарский край, г. Краснодар, ул. Володарского, д. 10","fullName":"ГБУЗ \"Городская больница №2 г. Краснодара\" МЗ КК (ранее МСЧ Масложиркомбинат)","type":"Прочее"},{"address":"350063, Краснодарский край, г. Краснодар, ул. Кирова, д. 9","fullName":"ГБУЗ \"Краевой клинический госпиталь для ветеранов войн им. проф. В.К.Красовитова\" МЗ КК (Запись в соответствии с ФЗ №5-ФЗ от 12.01.95 и др.)","type":"Краевые больницы"},{"address":"350062, г. Краснодар, ул. Атарбекова, д. 35","fullName":"ГБУЗ \"Детская стоматологическая поликлиника\" МЗ КК","type":"Стоматологическая поликлиника детская"},{"address":"350089, г. Краснодар, ул. 70лет Октября, 12/1","fullName":"ГБУЗ \"Детская стоматологическая поликлиника\" МЗ КК ОСП №1","type":"Стоматологическая поликлиника детская"},{"address":"350080, Краснодарский край, г. Краснодар, ул. Сормовская, 185","fullName":"ГБУЗ \"Городская поликлиника № 17 г. Краснодара\" МЗ КК Женская консультация №6","type":"Женская консультация"},{"address":"350000, г. Краснодар, ул. Красная, 50","fullName":"ГБУЗ \"Городская поликлиника № 1 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350020, г. Краснодар, ул. Коммунаров, 229","fullName":"ГБУЗ \"Городская поликлиника № 10 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350911, Краснодарский край, г. Краснодар, ул. Садовая, д. 9","fullName":"ГБУЗ \"Городская поликлиника № 11 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350037, Краснодарский край, г. Краснодар, х. Ленина, ул. Обрезная, 22","fullName":"ГБУЗ \"Городская поликлиника № 11 г. Краснодара\" МЗ КК ОСП (Обрезная) х. Ленина","type":"Поликлиника взрослая"},{"address":"350037, Краснодарский край, г. Краснодар, х. Ленина, ул. Пластунская, 24","fullName":"ГБУЗ \"Городская поликлиника № 11 г. Краснодара\" МЗ КК ОСП (Пластунская) х. Ленина","type":"Поликлиника взрослая"},{"address":"350060, Краснодарский край, г.Краснодар, пос. Лорис, ул. Васильченко, 23","fullName":"ГБУЗ \"Городская поликлиника № 11 г. Краснодара\" МЗ КК ОСП пос. Лорис","type":"Поликлиника взрослая"},{"address":"350039, г. Краснодар, ул. Вавилова , д. 9","fullName":"ГБУЗ \"Городская поликлиника № 12 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350039, Краснодарский край, г. Краснодар, ул. Вавилова, 9","fullName":"ГБУЗ \"Городская поликлиника № 12 г. Краснодара\" МЗ КК Детское отделение","type":"Поликлиника детская"},{"address":"350012, Краснодарский край, г. Краснодар, ул. Азовская, 3","fullName":"ГБУЗ \"Городская поликлиника № 12 г. Краснодара\" МЗ КК Обособленное структурное подразделение (взрослое)","type":"Поликлиника взрослая"},{"address":"350012, Краснодарский край, г. Краснодар, ул. Азовская, 3","fullName":"ГБУЗ \"Городская поликлиника № 12 г. Краснодара\" МЗ КК Обособленное структурное подразделение (детское)","type":"Поликлиника детская"},{"address":"350072, г. Краснодар, ул. Силантьева, 76/1","fullName":"ГБУЗ \"Городская поликлиника № 13 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350087, Краснодарский край, г. Краснодар, ул. им. Силантьева Ю.В., 76/1","fullName":"ГБУЗ \"Городская поликлиника № 13 г. Краснодара\" МЗ КК Детское отделение","type":"Поликлиника детская"},{"address":"350047, г. Краснодар, ул. Толбухина, д. 81","fullName":"ГБУЗ \"Городская поликлиника № 14 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350075, Краснодарский край, г. Краснодар, ул. Селезнева, д. 94","fullName":"ГБУЗ \"Городская поликлиника № 15 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"353075, Краснодарский край, г. Краснодар, ул. Сормовская, 10","fullName":"ГБУЗ \"Городская поликлиника № 15 г. Краснодара\" МЗ КК Обособленое структурное подразделение","type":"Поликлиника взрослая"},{"address":"350072, г. Краснодар, ул. Московская, 66","fullName":"ГБУЗ \"Городская поликлиника № 16 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350087, Краснодарский край, г. Краснодар, ул. Артюшкова, 5","fullName":"ГБУЗ \"Городская поликлиника № 16 г. Краснодара\" МЗ КК Филиал ул. Артюшкова","type":"Поликлиника взрослая"},{"address":"350059, Краснодарский край, г. Краснодар, ул. Генерала Трошева, 41","fullName":"ГБУЗ \"Городская поликлиника № 16 г. Краснодара\" МЗ КК Филиал ул. Генерала Трошева","type":"Поликлиника"},{"address":"350080, г. Краснодар, ул. Симферопольская, д. 16","fullName":"ГБУЗ \"Городская поликлиника № 17 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350055, г. Краснодар, Пашковский сельский округ, п. Знаменский, ул. Гагарина, 9/2","fullName":"ГБУЗ \"Городская поликлиника № 17 г. Краснодара\" МЗ КК Обособленное структурное подразделение п.Знаменский","type":"Поликлиника"},{"address":"350055, Краснодарский край, г. Новознаменский ж/р, ул. Благовещенская, 6","fullName":"ГБУЗ \"Городская поликлиника № 17 г. Краснодара\" МЗ КК Обособленное структурное подразделение п.Новознаменский","type":"Прочее"},{"address":"350910, г.Краснодар, Пашковский сельский округ, п. Подсобного производственного хозяйства биофабрики, ул. Донбасская, 8","fullName":"ГБУЗ \"Городская поликлиника № 17 г. Краснодара\" МЗ КК Обособленное структурное подразделение п.Пригородный","type":"Поликлиника"},{"address":"350051, г. Краснодар, ул. Офицерская, д. 33","fullName":"ГБУЗ \"Городская поликлиника № 19 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350044, г. Краснодар, ул. Калинина, д. 13, корп. 2","fullName":"ГБУЗ \"Городская поликлиника № 22 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350044, г. Краснодар, ст. Елизаветинская, ул. Новая, д. 46","fullName":"ГБУЗ \"Городская поликлиника № 23 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350032, Краснодарский край, г. Краснодар, ст. Елизаветинская, ул. Октябрьская, 55","fullName":"ГБУЗ \"Городская поликлиника № 23 г. Краснодара\" МЗ КК Детское отделение","type":"Поликлиника детская"},{"address":"350089, г. Краснодар, ул. Платановый Бульвар, д. 10/А","fullName":"ГБУЗ \"Городская поликлиника № 25 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350063, г. Краснодар, ул. Постовая, 18","fullName":"ГБУЗ \"Городская поликлиника № 26 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350061, г. Краснодар, ул. им. Дмитрия Благоева, 16","fullName":"ГБУЗ \"Городская поликлиника № 27 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350061, Краснодарский край, г. Краснодар, ул. Трудовой Славы, 19/2","fullName":"ГБУЗ \"Городская поликлиника № 27 г. Краснодара\" МЗ КК Детское отделение","type":"Поликлиника детская"},{"address":"350061, г. Краснодар, ул. Парусная, 10/2","fullName":"ГБУЗ \"Городская поликлиника № 27 г. Краснодара\" МЗ КК ОСП на Парусной","type":"Прочее"},{"address":"350065, г. Краснодар, ул. Трудовой Славы, 24","fullName":"ГБУЗ \"Городская поликлиника № 27 г. Краснодара\" МЗ КК ОСП на Трудовой Славы","type":"Прочее"},{"address":"350001, г. Краснодар, ул. Ставропольская, д. 142","fullName":"ГБУЗ \"Городская поликлиника № 3 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350000, г. Краснодар, ул. им. Гоголя, 91","fullName":"ГБУЗ \"Городская поликлиника № 4 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350004, г. Краснодар, ул. Калинина, 243","fullName":"ГБУЗ \"Городская поликлиника № 5 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350000, г. Краснодар, ул. Пушкина, д. 51","fullName":"ГБУЗ \"Городская поликлиника № 7 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350031, Краснодарский край, г. Краснодар, ул. 3-я Целиноградская, 1","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК","type":"Больница взрослая"},{"address":"350031, Краснодарский край, г. Краснодар, ул. 9-я Тихая, д. 5","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК Детское отделение","type":"Поликлиника детская"},{"address":"350031, Краснодарский край, г. Краснодар, Берёзовский сельский округ, пос. Березовый, 21/1","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП пос. Берёзовый","type":"Поликлиника"},{"address":"350077, Краснодарский край, г. Краснодар, Берёзовский сельский округ, пос. отделение №2 СКЗНИИСиВ, ул. Главная, 21","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП пос. Водники","type":"Поликлиника"},{"address":"350031, Краснодарский край, г. Краснодар, Берёзовский сельский округ, и. 1-е отделение свинооткормочного хозяйства «Прогресс», 10/А","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК пос. Прогресс","type":"Поликлиника"},{"address":"350030, Краснодарский край, г. Краснодар, Прикубанский округ, пос. Отделение №3 СКЗНИИСиВ, ул. им. Александры Приймак, дом 2/1","fullName":"ГБУЗ \"Городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП пос. Северный","type":"Прочее"},{"address":"350062, г. Краснодар, ул. Атарбекова, д. 27","fullName":"ГБУЗ \"Городская поликлиника № 9 г. Краснодара\" МЗ КК","type":"Поликлиника взрослая"},{"address":"350004, г. Краснодар, ул. Тургенева, д. 23","fullName":"ГБУЗ \"Детская городская поликлиника № 1 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350004, г. Краснодар, ул. Тургенева, 23","fullName":"ГБУЗ \"Детская городская поликлиника № 1 г. Краснодара\" МЗ КК Кабинет \"Здоровое детство\"","type":"Поликлиника детская"},{"address":"350038, г. Краснодар, ул. Северная, д. 500","fullName":"ГБУЗ \"Детская поликлиника № 2 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350038, Краснодарский край, пгт. Плодородный (ВНИИМК), 5/2","fullName":" ГБУЗ \"Детская поликлиника № 2 г. Краснодара\" МЗ КК ОСП пгт. Плодородный","type":"Прочее"},{"address":"350059, Краснодарский край, г. Краснодар, ул. Восточно-Кругликовская, 64","fullName":" ГБУЗ \"Детская поликлиника № 2 г. Краснодара\" МЗ КК (ул.Восточно-Кругликовская)","type":"Поликлиника детская"},{"address":"350040, г. Краснодар ул. Ставропольская, д. 113","fullName":"ГБУЗ \"Детская городская поликлиника № 3 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350000, г. Краснодар, ул. Коммунаров, д. 59","fullName":"ГБУЗ \"Детская городская поликлиника № 4 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350020, г. Краснодар, ул. Красная, д. 206","fullName":"ГБУЗ \"Детская городская поликлиника № 5 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350049, г. Краснодар, ул. Котовского, д. 117","fullName":"ГБУЗ \"Детская городская поликлиника № 6 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350080, г. Краснодар, ул. Симферопольская, д. 44","fullName":"ГБУЗ \"Детская городская поликлиника № 7 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350911, г. Краснодар, ул. Садовая, д. 5/3","fullName":"ГБУЗ \"Детская городская поликлиника № 8 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350910, г.Краснодар, п. Пригородный, ул. Донбасская, 6","fullName":"ГБУЗ \"Детская городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП п.Пригородный","type":"Поликлиника детская"},{"address":"355055, г. Краснодар, п. Знаменский, ул. Гагарина, 9/2","fullName":"ГБУЗ \"Детская городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП пос. Знаменский","type":"Поликлиника детская"},{"address":"350060, г. Краснодар, п. Лорис, дом 23","fullName":"ГБУЗ \"Детская городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП пос. Лорис","type":"Поликлиника детская"},{"address":"350037, г.Краснодар, х. Ленина, ул Пластунская, 24","fullName":"ГБУЗ \"Детская городская поликлиника № 8 г. Краснодара\" МЗ КК ОСП х.Ленина","type":"Поликлиника детская"},{"address":"350089, г. Краснодар, ул. Проспект Чекистов, д. 8/3","fullName":"ГБУЗ \"Детская городская поликлиника № 9 г. Краснодара\" МЗ КК","type":"Поликлиника детская"},{"address":"350033, г. Краснодар, ул. Ленина, д. 92","fullName":"ГБУЗ \"Детская стоматологическая поликлиника № 1\" МЗ КК","type":"Стоматологическая поликлиника детская"},{"address":"350058, г. Краснодар, ул. Ставропольская, д. 221","fullName":"ГБУЗ \"Детская стоматологическая поликлиника № 2\" МЗ КК","type":"Стоматологическая поликлиника детская"},{"address":"350007, Краснодарский край, г. Краснодар, ул. Захарова, д. 61","fullName":"ГБУЗ \"Детский лечебно-реабилитационный центр г. Краснодара\" МЗ КК (Запись только по направлению)","type":"Медицинский центр"},{"address":"350000, Краснодарский край, г. Краснодар, ул. Таманская, д. 130","fullName":"ГБУЗ \"Краевая клиническая больница № 2\" МЗ КК Женская Консультация №3","type":"Женская консультация"},{"address":"350000, Краснодарский край, г. Краснодар, ул. Красных Партизан, д. 6/2","fullName":"ГБУЗ \"Краевая клиническая больница № 2\" МЗ КК Женская Консультация №5","type":"Женская консультация"},{"address":"350051, Краснодарский край, г. Краснодар, пр. им. Репина, 3","fullName":"ГБУЗ \"НИИ - Краевая клиническая больница №1 им. проф. С.В.Очаповского\" МЗ КК Амбулаторное отделение","type":"Амбулатория"},{"address":"350056, Краснодарский край, . Индустриальный п, ул. Степная, 12","fullName":"ГБУЗ \"ГП № 13 г. Краснодара\" МЗ КК (Обособленное структурное подразделение г Краснодар Калининскии сельскии округ пос Индустриальныи ул Степная дом 12)","type":"Прочее"},{"address":"350000, Краснодарский край, г. Краснодар, ул. Гимназическая, д. 93","fullName":"ГБУЗ \"Родильный дом г. Краснодара\" МЗ КК Женская консультация № 1","type":"Женская консультация"},{"address":"350002, Краснодарский край, г. Краснодар, ул.Кузнечная, 167/1","fullName":"ГБУЗ \"Родильный дом г. Краснодара\" МЗ КК Женская консультация №2","type":"Женская консультация"},{"address":"350004, Краснодарский край, г. Краснодар,  ул. Котовского, 98","fullName":"ГБУЗ \"Родильный дом г. Краснодара\" МЗ КК Женская консультация №4","type":"Женская консультация"},{"address":"350072, Краснодарский край, г. Краснодар, ул. 40 лет Победы, 146/5","fullName":"ГБУЗ \"Родильный дом г. Краснодара\" МЗ КК Женская консультация №7","type":"Женская консультация"},{"address":"350033, г. Краснодар, ул. Железнодорожная, д. 12/1","fullName":"ГБУЗ \"Стоматологическая поликлиника №1\" МЗ КК","type":"Стоматологическая поликлиника взрослая"},{"address":"350065, г. Краснодар, ул. Гидростроителей, д. 34","fullName":"ГАУЗ \"Стоматологическая поликлиника №2\" МЗ КК","type":"Стоматологическая поликлиника взрослая"},{"address":"350078, г. Краснодар, ул. Тургенева, д. 203","fullName":"ГБУЗ \"Стоматологическая поликлиника №3\" МЗ КК","type":"Стоматологическая поликлиника взрослая"},{"address":"350908, Краснодарский край, ст-ца. Старокорсунская, ул. Красная, 58","fullName":"ГБУЗ \"Старокорсунская участковая больница г. Краснодара\" МЗ КК","type":"Участковая больница"},{"address":"350908, Краснодарский край, г. Краснодар. ст. Старокорсунская, ул. Красная, д. 58","fullName":"ГБУЗ \"Старокорсунская участковая больница г. Краснодара\" МЗ КК Детское отделение","type":"Больница детская"},{"address":"350072, г. Краснодар, ул. Московская, д. 96","fullName":"ЧУЗ \"Клиническая больница \"РЖД-Медицина\" г. Краснодар\" (поликлиника для взрослых)","type":"Поликлиника взрослая"}]}])
  }

  public getCodeForEmailVerify(email: string): Observable<void> {
    return this.#post(`${environment.apiUrl}`, { email })
  }

  public sendVerifyCode(code: string): Observable<void> {
    return this.#post(`${environment.apiUrl}`, { code });
  }

  public sendApplication(body: ApplicationForm): Observable<void> {
    return this.#post(`${environment.apiUrl}`, body);
  }

  public sendFile(fileFormData: FormData): Observable<void> {
    return this.#post(`${environment.apiUrl}`, fileFormData)
  }

  #get<T>(url:string, params?: ObjectType): Observable<T> {
    return this.httpClient.get<T>(url, {
      params
    });
  }

  #post<T>(url:string, body: any): Observable<T> {
    return this.httpClient.post<T>(url, body);
  }
}
